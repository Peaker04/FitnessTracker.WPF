<UserControl x:Class="FitnessTracker.WPF.Views.WorkoutPlanView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:models="clr-namespace:FitnessTracker.WPF.Models"
             xmlns:helpers="clr-namespace:FitnessTracker.WPF.Helpers"   
             xmlns:converters="clr-namespace:FitnessTracker.WPF.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800" Background="White">

    <UserControl.Resources>
        <converters:EnumToStringConverter x:Key="EnumToStringConverter"/>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </UserControl.Resources>

    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0" Margin="0,0,20,0">
            <TextBlock Text="Thiết Lập Kế Hoạch" FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>

            <TextBlock Text="Mục Tiêu" Margin="0,10,0,5"/>
            <ComboBox SelectedItem="{Binding SelectedGoal}" 
                      ItemsSource="{Binding Source={x:Static helpers:EnumValues.FitnessGoals}}" 
                      Height="30">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Converter={StaticResource EnumToStringConverter}}"/>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <TextBlock Text="Môi Trường Tập" Margin="0,10,0,5"/>
            <ComboBox SelectedItem="{Binding SelectedEnvironment}" 
                      ItemsSource="{Binding Source={x:Static helpers:EnumValues.Environments}}" 
                      Height="30">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Converter={StaticResource EnumToStringConverter}}"/>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <TextBlock Text="Số Buổi / Tuần" Margin="0,10,0,5"/>
            <Slider Minimum="1" Maximum="7" Value="{Binding DaysPerWeek}" TickFrequency="1" IsSnapToTickEnabled="True" AutoToolTipPlacement="TopLeft"/>
            <TextBlock Text="{Binding DaysPerWeek, StringFormat={}{0} buổi}" HorizontalAlignment="Right"/>

            <Button Command="{Binding GenerateAIPlanCommand}" 
                    Content="TẠO KẾ HOẠCH VỚI AI" 
                    Height="40" Margin="0,30,0,0"
                    Background="#FF6B35" Foreground="White" FontWeight="Bold" Cursor="Hand"/>

            <TextBlock Text="Đang xử lý..." Foreground="Gray" HorizontalAlignment="Center" Margin="0,10,0,0"
                       Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}"/>
        </StackPanel>

        <Border Grid.Column="1" BorderBrush="#DDDDDD" BorderThickness="1" CornerRadius="5" Background="#FAFAFA">
            <Grid Margin="15">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Kế Hoạch Được Đề Xuất" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>

                <TextBox Grid.Row="1" Text="{Binding GeneratedPlanText}" 
                         TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto"
                         IsReadOnly="True" Background="Transparent" BorderThickness="0"/>

                <Button Grid.Row="2" Command="{Binding SavePlanCommand}" 
                        Content="Lưu Kế Hoạch Này" HorizontalAlignment="Right" Width="150" Height="35" Margin="0,10,0,0"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>